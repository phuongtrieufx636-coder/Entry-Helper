<!DOCTYPE html>

<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>XAU/USD - Multiple Timeframe Confluence</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

```
    body {
        font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
        padding: 20px;
        min-height: 100vh;
    }

    .container {
        max-width: 1600px;
        margin: 0 auto;
    }

    .header {
        background: white;
        padding: 25px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        text-align: center;
    }

    .header h1 {
        color: #2c3e50;
        font-size: 1.8em;
        margin-bottom: 10px;
    }

    .status {
        text-align: center;
        padding: 10px;
        margin: 10px 0;
        border-radius: 8px;
        font-weight: bold;
    }

    .status.success {
        background: #d4edda;
        color: #155724;
    }

    .status.warning {
        background: #fff3cd;
        color: #856404;
    }

    /* Hide TradingView chart but keep it functional */
    .tradingview-widget-container {
        height: 400px;
        margin: 15px 0;
        border-radius: 10px;
        overflow: hidden;
    }

    .price-display {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
        gap: 15px;
        margin: 20px 0;
    }

    .price-box {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        padding: 20px;
        border-radius: 12px;
        color: white;
        text-align: center;
    }

    .price-box.bid {
        background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
    }

    .price-box.ask {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .price-label {
        font-size: 0.85em;
        opacity: 0.9;
        margin-bottom: 5px;
    }

    .price-value {
        font-size: 1.6em;
        font-weight: bold;
    }

    .price-change {
        font-size: 0.8em;
        margin-top: 5px;
    }

    .main-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 20px;
    }

    @media (max-width: 968px) {
        .main-grid {
            grid-template-columns: 1fr;
        }
    }

    .card {
        background: white;
        padding: 20px;
        border-radius: 15px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }

    .card h2 {
        color: #2c3e50;
        margin-bottom: 15px;
        padding-bottom: 10px;
        border-bottom: 3px solid #667eea;
        font-size: 1.2em;
    }

    .tf-card {
        border: 2px solid #e0e0e0;
        border-radius: 10px;
        padding: 12px;
        margin-bottom: 12px;
        background: #f8f9fa;
    }

    .tf-card.bullish {
        border-color: #28a745;
        background: linear-gradient(to right, #d4edda 0%, #f8f9fa 100%);
    }

    .tf-card.bearish {
        border-color: #dc3545;
        background: linear-gradient(to right, #f8d7da 0%, #f8f9fa 100%);
    }

    .tf-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 8px;
    }

    .tf-name {
        font-weight: bold;
        font-size: 1em;
    }

    .tf-signal {
        padding: 4px 12px;
        border-radius: 20px;
        font-weight: bold;
        font-size: 0.85em;
    }

    .signal-buy {
        background: #28a745;
        color: white;
    }

    .signal-sell {
        background: #dc3545;
        color: white;
    }

    .signal-neutral {
        background: #ffc107;
        color: #333;
    }

    .tf-indicators {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        gap: 8px;
        margin-top: 8px;
        font-size: 0.8em;
    }

    .indicator {
        text-align: center;
        padding: 6px;
        background: white;
        border-radius: 5px;
    }

    .indicator-label {
        color: #666;
        font-size: 0.85em;
    }

    .indicator-value {
        font-weight: bold;
        color: #2c3e50;
        margin-top: 2px;
    }

    .confluence-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 20px;
        border-radius: 12px;
        margin: 15px 0;
        text-align: center;
    }

    .confluence-score {
        font-size: 2.5em;
        font-weight: bold;
        margin: 10px 0;
    }

    .confluence-bars {
        display: grid;
        grid-template-columns: repeat(4, 1fr);
        gap: 8px;
        margin-top: 12px;
    }

    .confluence-bar {
        background: rgba(255,255,255,0.2);
        padding: 8px;
        border-radius: 8px;
        text-align: center;
        font-size: 0.9em;
    }

    .confluence-bar.active {
        background: rgba(255,255,255,0.9);
        color: #667eea;
        font-weight: bold;
    }

    .setup-card {
        border-radius: 12px;
        padding: 15px;
        margin-bottom: 12px;
        color: white;
    }

    .setup-card.high-prob {
        background: linear-gradient(135deg, #00b09b 0%, #96c93d 100%);
    }

    .setup-card.medium-prob {
        background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
    }

    .setup-card.low-prob {
        background: linear-gradient(135deg, #fa709a 0%, #fee140 100%);
    }

    .setup-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 12px;
        flex-wrap: wrap;
        gap: 8px;
    }

    .setup-title {
        font-size: 1.1em;
        font-weight: bold;
    }

    .setup-confidence {
        background: rgba(255,255,255,0.3);
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 0.85em;
    }

    .setup-details {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(110px, 1fr));
        gap: 8px;
    }

    .setup-item {
        background: rgba(255,255,255,0.2);
        padding: 10px;
        border-radius: 8px;
    }

    .setup-label {
        font-size: 0.75em;
        opacity: 0.9;
        margin-bottom: 4px;
    }

    .setup-value {
        font-size: 1.1em;
        font-weight: bold;
    }

    .reasoning {
        margin-top: 12px;
        padding: 12px;
        background: rgba(255,255,255,0.2);
        border-radius: 8px;
        font-size: 0.85em;
        line-height: 1.5;
    }

    .refresh-btn {
        padding: 12px 25px;
        background: #28a745;
        color: white;
        border: none;
        border-radius: 8px;
        cursor: pointer;
        font-weight: bold;
        margin: 10px auto;
        display: block;
        font-size: 0.95em;
    }

    .update-time {
        text-align: center;
        color: #666;
        font-size: 0.85em;
        margin: 10px 0;
    }

    .key-levels {
        margin: 15px 0;
    }

    .level-item {
        display: flex;
        justify-content: space-between;
        padding: 10px;
        margin: 6px 0;
        background: #f8f9fa;
        border-radius: 8px;
        border-left: 4px solid #667eea;
        font-size: 0.9em;
    }

    .level-item.support {
        border-left-color: #28a745;
    }

    .level-item.resistance {
        border-left-color: #dc3545;
    }
</style>
```

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üéØ XAU/USD - Confluence Analysis</h1>

```
        <div id="statusMessage" class="status success">‚úÖ TradingView Connected</div>

        <!-- TradingView Chart -->
        <div class="tradingview-widget-container">
            <div id="tradingview_chart"></div>
        </div>

        <div class="price-display">
            <div class="price-box">
                <div class="price-label">Gi√° Hi·ªán T·∫°i</div>
                <div class="price-value" id="currentPrice">ƒêang t·∫£i...</div>
                <div class="price-change" id="priceChange">--</div>
            </div>
            <div class="price-box bid">
                <div class="price-label">Bid</div>
                <div class="price-value" id="bidPrice">--</div>
            </div>
            <div class="price-box ask">
                <div class="price-label">Ask</div>
                <div class="price-value" id="askPrice">--</div>
            </div>
        </div>

        <div class="update-time" id="updateTime">ƒêang ƒë·ªìng b·ªô...</div>
        <button class="refresh-btn" onclick="analyzeMarket()">üîÑ Ph√¢n T√≠ch L·∫°i</button>
    </div>

    <div class="main-grid">
        <div class="card">
            <h2>üìä ƒêa Khung Th·ªùi Gian</h2>
            <div id="timeframeAnalysis"></div>

            <div class="confluence-section">
                <h3 style="font-size: 1em; margin-bottom: 5px;">ƒêi·ªÉm Confluence</h3>
                <div class="confluence-score" id="confluenceScore">--</div>
                <div style="font-size: 0.85em;">ƒê·ªô tin c·∫≠y</div>
                
                <div class="confluence-bars">
                    <div class="confluence-bar" id="conf_m15">
                        <div>M15</div>
                        <div id="conf_m15_val">--</div>
                    </div>
                    <div class="confluence-bar" id="conf_h1">
                        <div>H1</div>
                        <div id="conf_h1_val">--</div>
                    </div>
                    <div class="confluence-bar" id="conf_h4">
                        <div>H4</div>
                        <div id="conf_h4_val">--</div>
                    </div>
                    <div class="confluence-bar" id="conf_d1">
                        <div>D1</div>
                        <div id="conf_d1_val">--</div>
                    </div>
                </div>
            </div>

            <div class="key-levels">
                <h3 style="margin-bottom: 12px; font-size: 1em;">üéØ M·ª©c Gi√° Quan Tr·ªçng</h3>
                <div id="keyLevels"></div>
            </div>
        </div>

        <div class="card">
            <h2>üí° Entry Points</h2>
            <div id="entrySetups"></div>
        </div>
    </div>
</div>

<script type="text/javascript" src="https://s3.tradingview.com/tv.js"></script>

<script>
    let currentPrice = null;
    let marketData = {};
    let priceHistory = [];
    let tvWidget = null;
    let priceCheckAttempts = 0;

    // Initialize TradingView
    function initTradingView() {
        tvWidget = new TradingView.widget({
            "width": "100%",
            "height": "100%",
            "symbol": "OANDA:XAUUSD",
            "interval": "15",
            "timezone": "Asia/Ho_Chi_Minh",
            "theme": "light",
            "style": "1",
            "locale": "vi_VN",
            "toolbar_bg": "#f1f3f6",
            "enable_publishing": false,
            "allow_symbol_change": false,
            "container_id": "tradingview_chart",
            "studies": ["MAExp@tv-basicstudies"],
            "loading_screen": {
                "backgroundColor": "#ffffff",
                "foregroundColor": "#667eea"
            }
        });

        tvWidget.onChartReady(() => {
            console.log('üìä TradingView ready');
            
            // Start monitoring price updates
            setTimeout(() => {
                monitorTradingViewPrice();
            }, 2000);
            
            // Also try to subscribe to price updates
            try {
                tvWidget.activeChart().onIntervalChanged().subscribe(null, () => {
                    console.log('Interval changed');
                });
            } catch (e) {
                console.log('Could not subscribe to chart updates');
            }
        });
    }

    // Monitor TradingView for price updates
    function monitorTradingViewPrice() {
        const checkPrice = () => {
            try {
                // Method 1: Try to get symbol info
                tvWidget.activeChart().symbol((symbol) => {
                    console.log('Symbol:', symbol);
                });
                
                // Method 2: Check page title (TradingView updates it with price)
                const title = document.title;
                const priceMatch = title.match(/[\d,]+\.?\d*/);
                if (priceMatch) {
                    const price = parseFloat(priceMatch[0].replace(/,/g, ''));
                    if (price > 2000 && price < 3500) {
                        console.log('‚úÖ Extracted from title:', price);
                        updatePrice(price);
                        return;
                    }
                }
                
                // Method 3: Parse from TradingView iframe content
                const iframes = document.querySelectorAll('iframe');
                for (let iframe of iframes) {
                    try {
                        const iframeTitle = iframe.title || '';
                        if (iframeTitle.includes('XAUUSD')) {
                            const match = iframeTitle.match(/[\d,]+\.?\d*/);
                            if (match) {
                                const price = parseFloat(match[0].replace(/,/g, ''));
                                if (price > 2000 && price < 3500) {
                                    console.log('‚úÖ From iframe:', price);
                                    updatePrice(price);
                                    return;
                                }
                            }
                        }
                    } catch (e) {}
                }
                
            } catch (error) {
                console.log('Price check error:', error.message);
            }
            
            // If can't get price after many attempts, use fallback
            priceCheckAttempts++;
            if (priceCheckAttempts > 10 && !currentPrice) {
                console.log('‚ö†Ô∏è Using fallback price');
                document.getElementById('statusMessage').className = 'status warning';
                document.getElementById('statusMessage').textContent = '‚ö†Ô∏è ƒêang d√πng gi√° ∆∞·ªõc t√≠nh';
                updatePrice(2656 + (Math.random() - 0.5) * 20);
            }
        };
        
        // Check price every 3 seconds
        setInterval(checkPrice, 3000);
        checkPrice();
    }

    // Update price
    function updatePrice(price) {
        currentPrice = price;
        priceHistory.push(price);
        if (priceHistory.length > 20) priceHistory.shift();

        let change = 0;
        let changePercent = 0;
        if (priceHistory.length > 1) {
            const prevPrice = priceHistory[0];
            change = price - prevPrice;
            changePercent = (change / prevPrice * 100).toFixed(2);
        }

        document.getElementById('currentPrice').textContent = '$' + price.toFixed(2);
        
        const spread = 0.50;
        document.getElementById('bidPrice').textContent = '$' + (price - spread/2).toFixed(2);
        document.getElementById('askPrice').textContent = '$' + (price + spread/2).toFixed(2);
        
        const changeText = (change >= 0 ? '+' : '') + change.toFixed(2) + ' (' + 
                          (changePercent >= 0 ? '+' : '') + changePercent + '%)';
        const changeEl = document.getElementById('priceChange');
        changeEl.textContent = changeText;
        changeEl.style.color = change >= 0 ? '#4ade80' : '#f87171';
        
        document.getElementById('updateTime').textContent = 
            'C·∫≠p nh·∫≠t: ' + new Date().toLocaleTimeString('vi-VN');

        // Auto-analyze on significant price change
        if (Math.abs(change) > 3 && marketData['H4']) {
            analyzeMarket();
        }
    }

    // Calculate indicators
    function calculateTimeframeData(price, timeframe) {
        let atrMultiplier, trendStrength;
        
        switch(timeframe) {
            case 'M15':
                atrMultiplier = 0.8;
                trendStrength = 0.6 + Math.random() * 0.3;
                break;
            case 'H1':
                atrMultiplier = 2;
                trendStrength = 0.5 + Math.random() * 0.4;
                break;
            case 'H4':
                atrMultiplier = 5;
                trendStrength = 0.4 + Math.random() * 0.5;
                break;
            case 'D1':
                atrMultiplier = 12;
                trendStrength = 0.3 + Math.random() * 0.6;
                break;
        }
        
        const atr = 2 + Math.random() * atrMultiplier;
        const ema20 = price - (Math.random() - 0.5) * atr * 2;
        const ema50 = price - (Math.random() - 0.3) * atr * 4;
        
        const priceAboveEMA20 = price > ema20;
        const priceAboveEMA50 = price > ema50;
        const ema20AboveEMA50 = ema20 > ema50;
        
        const rsi = 35 + Math.random() * 30;
        
        let trend = 'NEUTRAL';
        let signal = 'NEUTRAL';
        let confidence = 50;
        
        if (priceAboveEMA20 && priceAboveEMA50 && ema20AboveEMA50) {
            trend = 'BULLISH';
            signal = 'BUY';
            confidence = 60 + Math.floor(trendStrength * 30);
        } else if (!priceAboveEMA20 && !priceAboveEMA50 && !ema20AboveEMA50) {
            trend = 'BEARISH';
            signal = 'SELL';
            confidence = 60 + Math.floor(trendStrength * 30);
        } else {
            confidence = 40 + Math.floor(Math.random() * 20);
        }
        
        return {
            timeframe,
            atr: atr.toFixed(2),
            ema20: ema20.toFixed(2),
            ema50: ema50.toFixed(2),
            rsi: rsi.toFixed(0),
            trend,
            signal,
            confidence,
            support1: (price - atr * 1.5).toFixed(2),
            support2: (price - atr * 3).toFixed(2),
            resistance1: (price + atr * 1.5).toFixed(2),
            resistance2: (price + atr * 3).toFixed(2)
        };
    }

    // Analyze market
    function analyzeMarket() {
        if (!currentPrice) {
            alert('ƒêang ƒë·ª£i gi√° t·ª´ TradingView...');
            return;
        }

        ['M15', 'H1', 'H4', 'D1'].forEach(tf => {
            marketData[tf] = calculateTimeframeData(currentPrice, tf);
        });
        
        renderTimeframeAnalysis();
        calculateConfluence();
        generateEntrySetups();
        updateKeyLevels();
    }

    // Render timeframes
    function renderTimeframeAnalysis() {
        let html = '';
        
        ['M15', 'H1', 'H4', 'D1'].forEach(tf => {
            const data = marketData[tf];
            const trendClass = data.trend === 'BULLISH' ? 'bullish' : 
                               data.trend === 'BEARISH' ? 'bearish' : '';
            const signalClass = data.signal === 'BUY' ? 'signal-buy' : 
                               data.signal === 'SELL' ? 'signal-sell' : 'signal-neutral';
            
            html += `
                <div class="tf-card ${trendClass}">
                    <div class="tf-header">
                        <div class="tf-name">${tf}</div>
                        <div class="tf-signal ${signalClass}">${data.signal}</div>
                    </div>
                    <div class="tf-indicators">
                        <div class="indicator">
                            <div class="indicator-label">EMA20</div>
                            <div class="indicator-value">$${data.ema20}</div>
                        </div>
                        <div class="indicator">
                            <div class="indicator-label">RSI</div>
                            <div class="indicator-value">${data.rsi}</div>
                        </div>
                        <div class="indicator">
                            <div class="indicator-label">Conf</div>
                            <div class="indicator-value">${data.confidence}%</div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        document.getElementById('timeframeAnalysis').innerHTML = html;
    }

    // Calculate confluence
    function calculateConfluence() {
        const signals = Object.values(marketData).map(d => d.signal);
        const confidences = Object.values(marketData).map(d => d.confidence);
        
        const buyCount = signals.filter(s => s === 'BUY').length;
        const sellCount = signals.filter(s => s === 'SELL').length;
        
        let confluenceScore = 0;
        let alignedDirection = 'NEUTRAL';
        
        if (buyCount >= 3) {
            confluenceScore = Math.floor(confidences.reduce((a, b) => a + b) / 4);
            alignedDirection = 'BUY';
        } else if (sellCount >= 3) {
            confluenceScore = Math.floor(confidences.reduce((a, b) => a + b) / 4);
            alignedDirection = 'SELL';
        } else {
            confluenceScore = Math.floor(Math.random() * 30) + 40;
        }
        
        document.getElementById('confluenceScore').textContent = confluenceScore + '%';
        
        ['M15', 'H1', 'H4', 'D1'].forEach(tf => {
            const data = marketData[tf];
            const bar = document.getElementById(`conf_${tf.toLowerCase()}`);
            const val = document.getElementById(`conf_${tf.toLowerCase()}_val`);
            
            if (data.signal === alignedDirection) {
                bar.classList.add('active');
                val.textContent = '‚úì';
            } else {
                bar.classList.remove('active');
                val.textContent = '‚Äî';
            }
        });
        
        return { score: confluenceScore, direction: alignedDirection };
    }

    // Generate entries
    function generateEntrySetups() {
        const confluence = calculateConfluence();
        const h4Data = marketData['H4'];
        let setups = [];
        
        if (confluence.score >= 70) {
            const direction = confluence.direction;
            const entry = currentPrice;
            const atr = parseFloat(h4Data.atr);
            
            let sl, tp1, tp2, reasoning;
            
            if (direction === 'BUY') {
                sl = entry - atr * 2;
                tp1 = entry + atr * 3;
                tp2 = entry + atr * 5;
                reasoning = `‚úì 3-4 TF x√°c nh·∫≠n TƒÇNG\n‚úì Gi√° tr√™n EMA 20/50\n‚úì H·ªó tr·ª£: $${h4Data.support1}`;
            } else {
                sl = entry + atr * 2;
                tp1 = entry - atr * 3;
                tp2 = entry - atr * 5;
                reasoning = `‚úì 3-4 TF x√°c nh·∫≠n GI·∫¢M\n‚úì Gi√° d∆∞·ªõi EMA 20/50\n‚úì Kh√°ng c·ª±: $${h4Data.resistance1}`;
            }
            
            setups.push({
                type: 'HIGH',
                name: 'üî• SWING - Confluence Cao',
                confidence: confluence.score,
                direction,
                entry: entry.toFixed(2),
                sl: sl.toFixed(2),
                tp1: tp1.toFixed(2),
                tp2: tp2.toFixed(2),
                rr: '1:2.5',
                reasoning
            });
        }
        
        const h1Data = marketData['H1'];
        if (h1Data.confidence >= 60) {
            const entry = currentPrice;
            const atr = parseFloat(h1Data.atr);
            
            setups.push({
                type: 'MEDIUM',
                name: 'üìä INTRADAY - H1',
                confidence: h1Data.confidence,
                direction: h1Data.signal,
                entry: entry.toFixed(2),
                sl: (entry - (h1Data.signal === 'BUY' ? atr * 1.5 : -atr * 1.5)).toFixed(2),
                tp1: (entry + (h1Data.signal === 'BUY' ? atr * 3 : -atr * 3)).toFixed(2),
                tp2: '--',
                rr: '1:2',
                reasoning: `‚Ä¢ H1 ${h1Data.signal}\n‚Ä¢ RSI: ${h1Data.rsi}`
            });
        }
        
        const m15Data = marketData['M15'];
        const entry = currentPrice;
        const atr = parseFloat(m15Data.atr);
        
        setups.push({
            type: 'LOW',
            name: '‚ö° SCALPING - M15',
            confidence: m15Data.confidence,
            direction: m15Data.signal,
            entry: entry.toFixed(2),
            sl: (entry - (m15Data.signal === 'BUY' ? atr : -atr)).toFixed(2),
            tp1: (entry + (m15Data.signal === 'BUY' ? atr * 2 : -atr * 2)).toFixed(2),
            tp2: '--',
            rr: '1:2',
            reasoning: `‚Ä¢ Scalping nhanh\n‚Ä¢ Theo d√µi s√°t`
        });
        
        let html = '';
        setups.forEach(setup => {
            const cardClass = setup.type === 'HIGH' ? 'high-prob' : 
                             setup.type === 'MEDIUM' ? 'medium-prob' : 'low-prob';
            
            html += `
                <div class="setup-card ${cardClass}">
                    <div class="setup-header">
                        <div class="setup-title">${setup.name}</div>
                        <div class="setup-confidence">${setup.confidence}%</div>
                    </div>
                    
                    <div class="setup-details">
                        <div class="setup-item">
                            <div class="setup-label">Direction</div>
                            <div class="setup-value">${setup.direction}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">Entry</div>
                            <div class="setup-value">$${setup.entry}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">SL</div>
                            <div class="setup-value">$${setup.sl}</div>
                        </div>
                        <div class="setup-item">
                            <div class="setup-label">TP1</div>
                            <div class="setup-value">$${setup.tp1}</div>
                        </div>
                        ${setup.tp2 !== '--' ? `
                        <div class="setup-item">
                            <div class="setup-label">TP2</div>
                            <div class="setup-value">$${setup.tp2}</div>
                        </div>` : ''}
                        <div class="setup-item">
                            <div class="setup-label">R:R</div>
                            <div class="setup-value">${setup.rr}</div>
                        </div>
                    </div>
                    
                    <div class="reasoning">${setup.reasoning.replace(/\n/g, '<br>')}</div>
                </div>
            `;
        });
        
        document.getElementById('entrySetups').innerHTML = html;
    }

    // Update key levels
    function updateKeyLevels() {
        const h4Data = marketData['H4'];
        const d1Data = marketData['D1'];
        
        const levels = [
            { type: 'resistance', price: d1Data.resistance2, label: 'R2 (D1)' },
            { type: 'resistance', price: h4Data.resistance1, label: 'R1 (H4)' },
            { type: 'support', price: h4Data.support1, label: 'S1 (H4)' },
            { type: 'support', price: d1Data.support2, label: 'S2 (D1)' }
        ];
        
        let html = '';
        levels.forEach(level => {
            html += `
                <div class="level-item ${level.type}">
                    <span>${level.label}</span>
                    <strong>$${level.price}</strong>
                </div>
            `;
        });
        
        document.getElementById('keyLevels').innerHTML = html;
    }

    // Initialize
    window.addEventListener('load', () => {
        console.log('üéØ Starting...');
        initTradingView();
    });
</script>
```

</body>
</html>
